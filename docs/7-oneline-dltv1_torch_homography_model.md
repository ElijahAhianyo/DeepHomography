# Oneline-dltv1 Torch Homography Model

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-Oneline_DLTv1.torch_homography_model.build_model-start--->
## Oneline-DLTv1.torch_homography_model.build_model

<!---Documatic-section-build_model-start--->
<!---Documatic-block-Oneline_DLTv1.torch_homography_model.build_model-start--->
<details>
	<summary><code>Oneline_DLTv1.torch_homography_model.build_model</code> code snippet</summary>

```python
def build_model(model_name, pretrained=False):
    if model_name == 'resnet34':
        model = resnet.resnet34(pretrained=False)
    elif model_name == 'resnet50':
        model = resnet.resnet50(pretrained=False)
    elif model_name == 'resnet101':
        model = resnet.resnet101(pretrained=False)
    elif model_name == 'resnet152':
        model = resnet.resnet152(pretrained=False)
    if model_name == 'resnet18':
        model.conv1 = nn.Conv2d(2, 64, kernel_size=7, stride=2, padding=3, bias=False)
        model.avg_pool = nn.AdaptiveAvgPool2d(1)
        model.last_linear = nn.Linear(512, 8)
    elif model_name == 'resnet34':
        model.conv1 = nn.Conv2d(2, 64, kernel_size=7, stride=2, padding=3, bias=False)
        model.avgpool = nn.AdaptiveAvgPool2d(1)
        model.fc = nn.Linear(512, 8)
    else:
        model.conv1 = nn.Conv2d(2, 64, kernel_size=7, stride=2, padding=3, bias=False)
        model.avgpool = nn.AdaptiveAvgPool2d(1)
        model.fc = nn.Linear(2048, 8)
    if pretrained == True:
        exclude_dict = ['conv1.weight', 'fc.weight', 'fc.bias']
        pretrained_dict = model_zoo.load_url(model_urls[model_name])
        model_dict = model.state_dict()
        pretrained_dict = {k: v for (k, v) in pretrained_dict.items() if k not in exclude_dict}
        model_dict.update(pretrained_dict)
        model.load_state_dict(model_dict)
    return model
```
</details>
<!---Documatic-block-Oneline_DLTv1.torch_homography_model.build_model-end--->
<!---Documatic-section-build_model-end--->

# #
<!---Documatic-section-Oneline_DLTv1.torch_homography_model.build_model-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)